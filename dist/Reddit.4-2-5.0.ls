import PluginBase from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/plugin-base.js';import ExtensionUtil from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/extension-util.js';var d=`${PluginBase.util.getNoCollisionUniqueAttr()}-thing`,c=/reddit.com\/r\/[^\/]*\/comments\//;function o(t){return`#siteTable>div.thing[${d}="${t}"]`}function i(t){let u=document.querySelector(t);u&&u.click()}var s={...PluginBase,languages:{},niceName:"Reddit",description:"Commands for Reddit.com",version:"4.2.5",apiVersion:2,match:/^https?:\/\/.*\.reddit.com/,authors:"Miko",init:async()=>{/^https?:\/\/www.reddit/.test(document.location.href)&&(document.location.href=document.location.href.replace(/^https?:\/\/.*\.reddit.com/,"http://old.reddit.com")),await PluginBase.util.ready();let t=0;for(let u of document.querySelectorAll("#siteTable>div.thing")){t++,u.setAttribute(d,""+t);let e=u.querySelector(".rank");e.setAttribute("style",`
                display: block !important;
                margin-right: 10px;
                opacity: 1 !important';
            `),e.innerText=""+t}},homophones:{navigate:"go",contract:"collapse",claps:"collapse",expense:"expand",explain:"expand",expanding:"expand","expand noun":"expand 9","it's been":"expand",expanse:"expand",expanded:"expand",stand:"expand",xpand:"expand",xmen:"expand",spend:"expand",span:"expand",spell:"expand",spent:"expand","reddit dot com":"reddit","read it":"reddit",shrink:"collapse",advert:"upvote"},commands:[{name:"View Comments",description:"View the comments of a reddit post.",match:"comments #",pageFn:async(t,u)=>{i(o(u)+" a.comments")}},{name:"Visit Post",description:"Equivalent of clicking a reddit post.",match:["visit[ #/]"],pageFn:async(t,u)=>{c.test(window.location.href)?i("#siteTable p.title a.title"):i(o(u)+" a.title")}},{name:"Expand",description:"Expand a preview of a post, or a comment by it's position (rank).",match:["expand[ #/]","# expand"],pageFn:async(t,u)=>{if(typeof u!="undefined"){let e=document.querySelector(`${o(u)} .expando-button.collapsed`);e.click(),PluginBase.util.scrollToAnimated(e,-25)}else{let e=document.querySelector("#siteTable .thing .expando-button.collapsed"),n=Array.from(document.querySelectorAll(".commentarea > div > .thing.collapsed"));if(e&&PluginBase.util.isVisible(e))e.click();else{let a;for(a of n.reverse())if(PluginBase.util.isVisible(a)){a.querySelector(".comment.collapsed a.expand").click();return}}}},test:async(t,u,e)=>{await e.url(`${t.context.localPageDomain}/reddit-r-comics.html?fakeUrl=https://www.reddit.com/r/comics`);let n="#thing_t3_dvpn38 > div > div > div.expando-button.collapsed",a=await e.$(n);t.true(await a.isExisting()),await u("expand for"),t.true((await a.getAttribute("class")).split(" ").includes("expanded"))}},{name:"Collapse",description:"Collapse an expanded preview (or comment if viewing comments). Defaults to topmost in the view port.",match:["collapse[ #/]","close"],pageFn:async(t,u)=>{let e=u===null||isNaN(Number(u))?null:Number(u);if(e!==null)document.querySelector(o(e)+" .expando-button:not(.collapsed)").click();else for(let n of document.querySelectorAll("#siteTable .thing .expando-button.expanded, .commentarea>div>div.thing:not(.collapsed)>div>p>a.expand"))if(PluginBase.util.isVisible(n)){n.click();break}},test:async(t,u,e)=>{await e.url("https://old.reddit.com/r/IAmA/comments/z1c9z/i_am_barack_obama_president_of_the_united_states/"),await e.execute(()=>{document.querySelector(".commentarea").scrollIntoView()});let n=await e.$("//div[contains(@class, 'noncollapsed')][contains(@class, 'comment')][@data-author='Biinaryy']"),a=await e.$("//p[contains(text(), 'HE KNOWS')]");t.true(await a.isDisplayed(),"tier two comment should be visible"),await u(),t.true((await n.getAttribute("class")).includes("collapsed"),"comment under test needs collapsed class"),t.false(await a.isDisplayed(),"tier two comment should not be visible")}},{name:"Go to Subreddit",match:{fn:({normTs:t,preTs:u})=>{let e=/\b(?:go to |show )?(?:are|our|r) (.*)/,n=u.match(e);if(n){let a=n.index+n[0].length;return[n.index,a,[n[1].replace(/\s/g,"")]]}},description:"go to/show r [subreddit name] (do not say slash)"},isFinal:!0,nice:(t,u)=>`go to r/${u}`,pageFn:async(t,u)=>{window.location.href=`https://old.reddit.com/r/${u}`}},{name:"Go to Reddit",global:!0,match:["[/go to ]reddit"],minConfidence:.5,pageFn:async()=>{document.location.href="https://old.reddit.com"}},{name:"Clear Vote",description:"Unsets the last vote so it's neither up or down.",match:["[clear/reset] vote[ #/]"],pageFn:async(t,u)=>{let e=u===null||isNaN(Number(u))?1:Number(u);i(`${o(e)} .arrow.downmod,${o(e)} .arrow.upmod`)}},{name:"Downvote",match:["downvote[ #/]"],description:"Downvote the current post or a post # (doesn't work for comments yet)",pageFn:async(t,u)=>{let e=u===null||isNaN(Number(u))?1:Number(u);i(`${o(e)} .arrow.down:not(.downmod)`)}},{name:"Upvote",match:["upvote[ #/]"],description:"Upvote the current post or a post # (doesn't work for comments yet)",pageFn:async(t,u)=>{let e=u===null||isNaN(Number(u))?1:Number(u);i(`${o(e)} .arrow.up:not(.upmod)`)}},{name:"Expand All Comments",description:"Expands all the comments.",match:["expand all[/ comments]"],pageFn:async()=>{for(let t of document.querySelectorAll(".thing.comment.collapsed a.expand"))t.click()},test:async(t,u,e)=>{await e.url("https://old.reddit.com/r/OldSchoolCool/comments/2uak5a/arnold_schwarzenegger_flexing_for_two_old_ladies/co6nw85/"),t.truthy((await e.$$(".thing.comment.collapsed")).length,"should be some collapsed items");let n=(await e.$$(".thing.comment.collapsed")).length;await u(),t.true((await e.$$(".thing.comment.collapsed")).length<n-5,"at least 5 comments have been expanded")}}]};s.languages.ja={niceName:"レディット",description:"Redditで操作します",authors:"Miko",commands:{"View Comments":{name:"コメントを診ます",match:["こめんと#"]}}};s.languages.ru={niceName:"Реддит",description:"Команды для сайта Reddit.com",authors:"Hanna",homophones:{reddit:"реддит",голоса:"голос за"},commands:{"View Comments":{name:"Открыть комментарии",description:"Открывает комментарии к посту названного номера.",match:["[комментарии/комменты] к #"]},"Visit Post":{name:"Открыть пост",description:"Кликает пост названного номера.",match:["открыть пост[/ #]"]},Expand:{name:"Развернуть",description:"Развернуть превью поста или комментария названного номера.",match:["развернуть[/ #]","# развернуть"]},Collapse:{name:"Свернуть",description:"Свернуть развернутый пост или комментарий. Если не назван номер, автоматически сворачивает самый верхний пост/ комментарий в пределах экрана.",match:["свернуть[/ #]","закрыть"]},"Go to Reddit":{name:"Открыть реддит",description:"Переходит на сайт reddit.com",match:["реддит"]},"Clear Vote":{name:"Убрать голос",description:"Убирает последний голос за или против последнего поста или поста названного номера",match:["убрать голос[ #/]"]},Downvote:{name:"Голос против",description:"Голосует против данного поста или поста названного # (пока нет поддержки комментариев)",match:["голос против[ #/]"]},Upvote:{name:"Голос за",description:"Голосует за данный пост или пост названного # (пока нет поддержки комментариев)",match:["голос за[ #/]"]},"Expand All Comments":{name:"Показать все комментарии",description:"Открывает все комментарии к данному посту",match:["[показать/открыть] все комментарии"]}}};var r=s;export{r as default};
LS-SPLITallPlugins.Reddit=(()=>{var a=`${PluginBase.util.getNoCollisionUniqueAttr()}-thing`,c=/reddit.com\/r\/[^\/]*\/comments\//;function o(n){return`#siteTable>div.thing[${a}="${n}"]`}function i(n){let e=document.querySelector(n);e&&e.click()}var s={...PluginBase,init:async()=>{/^https?:\/\/www.reddit/.test(document.location.href)&&(document.location.href=document.location.href.replace(/^https?:\/\/.*\.reddit.com/,"http://old.reddit.com")),await PluginBase.util.ready();let n=0;for(let e of document.querySelectorAll("#siteTable>div.thing")){n++,e.setAttribute(a,""+n);let t=e.querySelector(".rank");t.setAttribute("style",`
                display: block !important;
                margin-right: 10px;
                opacity: 1 !important';
            `),t.innerText=""+n}},commands:{"View Comments":{pageFn:async(n,e)=>{i(o(e)+" a.comments")}},"Visit Post":{pageFn:async(n,e)=>{c.test(window.location.href)?i("#siteTable p.title a.title"):i(o(e)+" a.title")}},Expand:{pageFn:async(n,e)=>{if(typeof e!="undefined"){let t=document.querySelector(`${o(e)} .expando-button.collapsed`);t.click(),PluginBase.util.scrollToAnimated(t,-25)}else{let t=document.querySelector("#siteTable .thing .expando-button.collapsed"),l=Array.from(document.querySelectorAll(".commentarea > div > .thing.collapsed"));if(t&&PluginBase.util.isVisible(t))t.click();else{let r;for(r of l.reverse())if(PluginBase.util.isVisible(r)){r.querySelector(".comment.collapsed a.expand").click();return}}}}},Collapse:{pageFn:async(n,e)=>{let t=e===null||isNaN(Number(e))?null:Number(e);if(t!==null)document.querySelector(o(t)+" .expando-button:not(.collapsed)").click();else for(let l of document.querySelectorAll("#siteTable .thing .expando-button.expanded, .commentarea>div>div.thing:not(.collapsed)>div>p>a.expand"))if(PluginBase.util.isVisible(l)){l.click();break}}},"Go to Subreddit":{match:{en:({normTs:n,preTs:e})=>{let t=/\b(?:go to |show )?(?:are|our|r) (.*)/,l=e.match(t);if(l){let r=l.index+l[0].length;return[l.index,r,[l[1].replace(/\s/g,"")]]}}},isFinal:!0,nice:(n,e)=>`go to r/${e}`,pageFn:async(n,e)=>{window.location.href=`https://old.reddit.com/r/${e}`}},"Go to Reddit":{pageFn:async()=>{document.location.href="https://old.reddit.com"}},"Clear Vote":{pageFn:async(n,e)=>{let t=e===null||isNaN(Number(e))?1:Number(e);i(`${o(t)} .arrow.downmod,${o(t)} .arrow.upmod`)}},Downvote:{pageFn:async(n,e)=>{let t=e===null||isNaN(Number(e))?1:Number(e);i(`${o(t)} .arrow.down:not(.downmod)`)}},Upvote:{pageFn:async(n,e)=>{let t=e===null||isNaN(Number(e))?1:Number(e);i(`${o(t)} .arrow.up:not(.upmod)`)}},"Expand All Comments":{pageFn:async()=>{for(let n of document.querySelectorAll(".thing.comment.collapsed a.expand"))n.click()}}}};return s})();
LS-SPLITallPlugins.Reddit=(()=>{var i=`${PluginBase.util.getNoCollisionUniqueAttr()}-thing`,r=/reddit.com\/r\/[^\/]*\/comments\//;function l(t){return`#siteTable>div.thing[${i}="${t}"]`}function c(t){let e=document.querySelector(t);e&&e.click()}var o={...PluginBase,init:async()=>{/^https?:\/\/www.reddit/.test(document.location.href)&&(document.location.href=document.location.href.replace(/^https?:\/\/.*\.reddit.com/,"http://old.reddit.com")),await PluginBase.util.ready();let t=0;for(let e of document.querySelectorAll("#siteTable>div.thing")){t++,e.setAttribute(i,""+t);let n=e.querySelector(".rank");n.setAttribute("style",`
                display: block !important;
                margin-right: 10px;
                opacity: 1 !important';
            `),n.innerText=""+t}},commands:{"Go to Reddit":{pageFn:async()=>{document.location.href="https://old.reddit.com"}}}};return o})();
