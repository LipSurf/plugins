import PluginBase from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/plugin-base.js';import ExtensionUtil from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/extension-util.js';var n=`${PluginBase.util.getNoCollisionUniqueAttr()}-thing`;var o={languages:{ja:{niceName:"レディット",description:"Redditで操作します",authors:"Miko",commands:{"View Comments":{name:"コメントを診ます",match:["こめんと#"]}}},ru:{niceName:"Реддит",description:"Команды для сайта Reddit.com",authors:"Hanna, Miko",homophones:{reddit:"реддит",голоса:"голос за"},commands:{"View Comments":{name:"Открыть комментарии",description:"Открывает комментарии к посту названного номера.",match:["[комментарии/комменты] к #"]},"Visit Post":{name:"Открыть пост",description:"Кликает пост названного номера.",match:["открыть пост[/ #]"]},"Visit Current":{name:"Открыть пост",description:"Кликает пост.",match:["открыть пост"]},Expand:{name:"Развернуть",description:"Развернуть превью поста или комментария названного номера.",match:["развернуть #","# развернуть"]},"Expand Current":{name:"Развернуть",description:"Развернуть превью поста или комментария.",match:"развернуть"},Collapse:{name:"Свернуть",description:"Свернуть развернутый пост или комментарий. Если не назван номер, автоматически сворачивает самый верхний пост/ комментарий в пределах экрана.",match:["[свернуть/закрыть] #"]},"Collapse Current":{name:"Свернуть",description:"Свернуть развернутый пост или комментарий. Если не назван номер, автоматически сворачивает самый верхний пост/ комментарий в пределах экрана.",match:["свернуть","закрыть"]},"Go to Reddit":{name:"Открыть реддит",description:"Переходит на сайт reddit.com",match:"реддит"},"Clear Vote":{name:"Убрать голос",description:"Убирает последний голос за или против последнего поста или поста названного номера",match:"убрать голос #"},"Clear Vote Current":{name:"Убрать голос",description:"Убирает последний голос за или против последнего поста или поста",match:"убрать голос"},Downvote:{name:"Голос против",description:"Голосует поста названного # (пока нет поддержки комментариев)",match:"голос против #"},"Downvote Current":{name:"Голос против",description:"Голосует против данного поста (пока нет поддержки комментариев)",match:"голос против"},Upvote:{name:"Голос за",description:"Голосует за пост названного # (пока нет поддержки комментариев)",match:"голос за #"},"Upvote Current":{name:"Голос за",description:"Голосует за данный пост (пока нет поддержки комментариев)",match:"голос за"},"Expand All Comments":{name:"Показать все комментарии",description:"Открывает все комментарии к данному посту",match:["[показать/открыть] все комментарии"]}}}},niceName:"Reddit",description:"Commands for Reddit.com",version:"4.4.0",apiVersion:2,match:/^https?:\/\/.*\.reddit.com/,authors:"Miko",homophones:{navigate:"go",contract:"collapse",claps:"collapse",expense:"expand",explain:"expand",expanding:"expand","expand noun":"expand 9","it's been":"expand",expanse:"expand",expanded:"expand",stand:"expand",xpand:"expand",xmen:"expand",spend:"expand",span:"expand",spell:"expand",spent:"expand","reddit dot com":"reddit","read it":"reddit",shrink:"collapse",advert:"upvote",download:"downvote"},contexts:{"Post List":{commands:["View Comments","Visit Post","Expand","Collapse","Upvote","Downvote","Clear Vote"]},Post:{commands:["Upvote Current","Downvote Current","Clear Vote Current","Visit Current","Expand Current","Collapse Current","Expand All Comments"]}},commands:[{name:"Go to Reddit",global:!0,match:["[/go to ]reddit"],minConfidence:.5},{name:"Go to Subreddit",match:{fn:()=>{},description:"go to/show r [subreddit name] (do not say slash)"},isFinal:!0,nice:(t,e)=>`go to r/${e}`},{name:"View Comments",description:"View the comments of a reddit post.",match:["comments #","# comments"],normal:!1},{name:"Visit Post",description:"Equivalent of clicking a reddit post.",match:["visit #","# visit"],normal:!1},{name:"Expand",description:"Expand a preview of a post, or a comment by it's position (rank).",match:["expand #","# expand"],normal:!1},{name:"Collapse",description:"Collapse an expanded preview (or comment if viewing comments). Defaults to topmost in the view port.",match:["collapse #","# collapse"],normal:!1},{name:"Upvote",match:["upvote #","# upvote"],description:"Upvote the post # (doesn't work for comments yet)",normal:!1},{name:"Downvote",match:["downvote #","# downvote"],description:"Downvote the post # (doesn't work for comments yet)",normal:!1},{name:"Clear Vote",description:"Unsets the upvote/downvote so it's neither up or down.",match:["[clear/reset] vote #","# [clear/reset] vote"],normal:!1},{name:"Upvote Current",match:"upvote",description:"Upvote the current post.",normal:!1},{name:"Downvote Current",match:"downvote",description:"Downvote the post # (doesn't work for comments yet)",normal:!1},{name:"Clear Vote Current",description:"Unsets the upvote/downvote so it's neither up or down.",match:["[clear/reset] vote"],normal:!1},{name:"Visit Current",description:"Click the link for the post that we're in.",match:"visit",normal:!1},{name:"Expand Current",description:"Expand the post that we're in.",match:"expand",normal:!1},{name:"Collapse Current",description:"Collapse the current post that we're in.",match:["collapse","close"],normal:!1},{name:"Expand All Comments",description:"Expands all the comments.",match:["expand all[/ comments]"],normal:!1}]};export{o as default};
LS-SPLITallPlugins.Reddit=(()=>{function b(t,e){Object.keys(t).forEach(n=>{e.style[n]=t[n]})}function r(t,e){return(e||document).querySelector(t)}function p(t,e){return(e||document).querySelectorAll(t)}var g=`${PluginBase.util.getNoCollisionUniqueAttr()}-thing`,C=/reddit.com\/r\/[^\/]*\/comments\//,i=!1,P=null,E=null,w=null,d=0,v=!1,k,l={old:{post:{thing:"#siteTable>.thing",title:"a.title",expandBtn:".expando-button",commentarea:".commentarea"},comments:{select:"a.comments",expandBtn:".expando-button",comment:{select:".comment",expandBtn:"a.expand"}},special:{collapsed:".collapsed",expanded:".expanded",notCollapsed:":not(.collapsed)"},vote:{btn:"#siteTable *[role='button']",up:".arrow.up:not(.upmod)",down:".arrow.down:not(.downmod)",upmod:".arrow.upmod",downmod:".arrow.downmod"}},latest:{home:"a[aria-label='Home']",post:{thing:".Post"},comments:{select:"a[data-click-id='comments']",threadline:".threadline",comment:{select:".Comment",expandBtn:".icon-expand"}},vote:{btn:".voteButton",up:".voteButton[aria-label='upvote']",down:".voteButton[aria-label='downvote']",pressed:".voteButton[aria-pressed='true']",unpressed:".voteButton[aria-pressed='false']"}}};function u(t){return i?`${l.old.post.thing}[${g}="${t}"]`:`${l.latest.post.thing}[${g}="${t}"]`}function B(t){let e=r(t);e&&e.click()}function x(t){parseFloat(getComputedStyle(t).width)&&t.click()}function R(t){let e=document.createElement("span");return e.textContent=t,e.className="post-number",b({position:"absolute",bottom:"2px",right:"2px",fontWeight:700,opacity:.7},e),e}function T(t,e){if(e)return t.forEach(n=>{d+=1,n.setAttribute(g,`${d}`);let o=r(".rank",n);b({display:"block",marginRight:"10px",opacity:"1 !important"},o)});t.forEach(S)}function S(t){t&&getComputedStyle(t).display!=="none"&&!t.querySelector(".post-number")&&(d+=1,t.setAttribute(g,`${d}`),t.style.position="relative",t.appendChild(R(d)))}function D(t){let{old:e,latest:n}=l,o=i?e.post.thing:n.post.thing;t.forEach(s=>{s.addedNodes.forEach(c=>{let a=r(o,c);S(a)})})}function I(t){E=new MutationObserver(D),E.observe(t,{childList:!0})}function q(t){return t[0].parentNode.parentNode.parentNode}function y(t,e){let{old:n,latest:o}=l,s=i?n.vote[t]:o.vote[t];return e?`${u(e)} ${s}`:s}function O(t){let{old:e,latest:n}=l,o=t&&u(t);return t&&i?`${o} ${e.vote.downmod}, ${o} ${e.vote.upmod}`:!t&&i?`${e.vote.downmod},${e.vote.upmod}`:t&&!i?`${o} ${n.vote.pressed}`:n.vote.pressed}function m(t,e){let n="";t==="up"&&(n=y("up",e)),t==="down"&&(n=y("down",e)),t==="clear"&&(n=O(e)),B(n)}function F(){let{post:t,special:e,comments:n}=l.old,{comment:o}=n,s=`${o.select}${e.notCollapsed} ${o.expandBtn}`,c=l.latest.comments.threadline;return{postExpBtn:i?`${t.expandBtn}${e.expanded}`:"",comExpBtn:i?s:c}}function h(){let{comments:t,special:e,post:n}=l.old,o={comExpBtn:"",postExpBtn:"",comment:""};return i?(o.comExpBtn=t.comment.expandBtn,o.postExpBtn=`${n.thing} ${t.expandBtn}`,o.comment=`${t.comment.select}${e.collapsed}`):(o.comment=l.latest.comments.comment.select,o.comExpBtn=l.latest.comments.comment.expandBtn),o}async function U(){let{postExpBtn:t,comExpBtn:e,comment:n}=h(),o=!!t&&r(t)||null;if(o&&PluginBase.util.isVisible(o))o.click();else{let s=i?n:e,c,a=Array.from(p(s));for(c of a.reverse())if(PluginBase.util.isVisible(c))return i?r(e,c).click():x(c.parentNode)}}async function W(){let{comment:t,comExpBtn:e}=h(),n=i?`${t} ${e}`:e;for(let o of p(n))i?o.click():x(o.parentNode)}function _(){let{postExpBtn:t,comExpBtn:e}=F(),n=!!t&&r(t)||null,o=p(e);n&&PluginBase.util.isVisible(n)&&n.click();for(let s of o)if(PluginBase.util.isVisible(s)){s.click();break}}function A(){v=!1,d=0}function $(){if(k=location.href,v)return;let{old:t,latest:e}=l,n=i?t.post.thing:e.post.thing;w=p(n),v=!0,T(w,i),i||(window.addEventListener("click",L),P=q(w),I(P))}function V(){setTimeout(()=>{location.hostname.endsWith("reddit.com")?(A(),$(),N(C.test(location.href))):PluginBase.util.removeContext("Post List","Post")},3e3)}function L(){setTimeout(()=>{k!==location.href&&f("popstate")})}function N(t=!1){t?(PluginBase.util.prependContext("Post"),PluginBase.util.removeContext("Post List")):(PluginBase.util.prependContext("Post List"),PluginBase.util.removeContext("Post"))}function f(t){let e=new Event(t);window.dispatchEvent(e)}var G={...PluginBase,init:async()=>{location.hostname.endsWith("reddit.com")&&(i=/https:\/\/old/.test(location.href),await PluginBase.util.ready(),window.addEventListener("load",$),window.addEventListener("popstate",V),setTimeout(()=>{v||f("load")},2e3),N(C.test(location.href)))},destroy:()=>{A(),PluginBase.util.removeContext("Post List","Post"),window.removeEventListener("load",$),!i&&E.disconnect(),!i&&window.removeEventListener("popstate",V),!i&&window.removeEventListener("click",L)},commands:{"Go to Reddit":{pageFn:()=>{document.location.href="https://reddit.com"}},"Go to Subreddit":{match:{en:({normTs:t,preTs:e})=>{let n=/\b(?:go to |show )?(?:are|our|r) (.*)/,o=e.match(n);if(o){let s=o.index+o[0].length;return[o.index,s,[o[1].replace(/\s/g,"")]]}}},isFinal:!0,nice:(t,e)=>`go to r/${e}`,pageFn:(t,e)=>{window.location.href=`https://reddit.com/r/${e}`}},"View Comments":{pageFn:(t,e)=>{f("popstate");let n=i?` ${l.old.comments.select}`:` ${l.latest.comments.select}`;B(u(e)+n)}},"Visit Post":{pageFn:(t,e)=>{f("popstate");let n=i?` ${l.old.post.title}`:l.latest.post.thing;B(u(e)+n)}},Expand:{pageFn:(t,e)=>{let{comments:n,special:o}=l.old,s=r(`${u(e)} ${n.expandBtn}${o.collapsed}`);s.click(),PluginBase.util.scrollToAnimated(s,-25)}},Collapse:{pageFn:(t,e)=>{let{comments:n,special:o}=l.old,s=r(u(e)+` ${n.expandBtn}${o.expanded}`);s==null||s.click()}},Upvote:{pageFn:(t,e)=>{m("up",e)}},Downvote:{pageFn:(t,e)=>{m("down",e)}},"Clear Vote":{pageFn:(t,e)=>{m("clear",e)}},"Upvote Current":{pageFn:()=>m("up")},"Downvote Current":{pageFn:()=>m("down")},"Clear Vote Current":{pageFn:()=>m("clear")},"Visit Current":{pageFn:()=>{f("popstate"),B("#siteTable a.title")}},"Expand Current":{pageFn:async function(){let{postExpBtn:e,comExpBtn:n,comment:o}=h(),s=!!e&&r(e)||null;if(s&&PluginBase.util.isVisible(s))s.click();else{let c=i?o:n,a,M=Array.from(p(c));for(a of M.reverse())if(PluginBase.util.isVisible(a))return i?r(n,a).click():x(a.parentNode)}}},"Collapse Current":{pageFn:function(){let{postExpBtn:e,comExpBtn:n}=F(),o=!!e&&r(e)||null,s=p(n);o&&PluginBase.util.isVisible(o)&&o.click();for(let c of s)if(PluginBase.util.isVisible(c)){c.click();break}}},"Expand All Comments":{pageFn:async function(){let{comment:e,comExpBtn:n}=h(),o=i?`${e} ${n}`:n;for(let s of p(o))i?s.click():x(s.parentNode)}}}};return G})();
LS-SPLITallPlugins.Reddit=(()=>{function B(t,e){Object.keys(t).forEach(n=>{e.style[n]=t[n]})}function r(t,e){return(e||document).querySelector(t)}function d(t,e){return(e||document).querySelectorAll(t)}var u=`${PluginBase.util.getNoCollisionUniqueAttr()}-thing`,h=/reddit.com\/r\/[^\/]*\/comments\//,s=!1,x=null,p=null,f=null,a=0,m=!1,w,i={old:{post:{thing:"#siteTable>.thing",title:"a.title",expandBtn:".expando-button",commentarea:".commentarea"},comments:{select:"a.comments",expandBtn:".expando-button",comment:{select:".comment",expandBtn:"a.expand"}},special:{collapsed:".collapsed",expanded:".expanded",notCollapsed:":not(.collapsed)"},vote:{btn:"#siteTable *[role='button']",up:".arrow.up:not(.upmod)",down:".arrow.down:not(.downmod)",upmod:".arrow.upmod",downmod:".arrow.downmod"}},latest:{home:"a[aria-label='Home']",post:{thing:".Post"},comments:{select:"a[data-click-id='comments']",threadline:".threadline",comment:{select:".Comment",expandBtn:".icon-expand"}},vote:{btn:".voteButton",up:".voteButton[aria-label='upvote']",down:".voteButton[aria-label='downvote']",pressed:".voteButton[aria-pressed='true']",unpressed:".voteButton[aria-pressed='false']"}}};function E(t){return s?`${i.old.post.thing}[${u}="${t}"]`:`${i.latest.post.thing}[${u}="${t}"]`}function N(t){let e=r(t);e&&e.click()}function b(t){parseFloat(getComputedStyle(t).width)&&t.click()}function R(t){let e=document.createElement("span");return e.textContent=t,e.className="post-number",B({position:"absolute",bottom:"2px",right:"2px",fontWeight:700,opacity:.7},e),e}function T(t,e){if(e)return t.forEach(n=>{a+=1,n.setAttribute(u,`${a}`);let o=r(".rank",n);B({display:"block",marginRight:"10px",opacity:"1 !important"},o)});t.forEach($)}function $(t){t&&getComputedStyle(t).display!=="none"&&!t.querySelector(".post-number")&&(a+=1,t.setAttribute(u,`${a}`),t.style.position="relative",t.appendChild(R(a)))}function V(t){let{old:e,latest:n}=i,o=s?e.post.thing:n.post.thing;t.forEach(l=>{l.addedNodes.forEach(c=>{let g=r(o,c);$(g)})})}function q(t){p=new MutationObserver(V),p.observe(t,{childList:!0})}function O(t){return t[0].parentNode.parentNode.parentNode}function P(t,e){let{old:n,latest:o}=i,l=s?n.vote[t]:o.vote[t];return e?`${E(e)} ${l}`:l}function I(t){let{old:e,latest:n}=i,o=t&&E(t);return t&&s?`${o} ${e.vote.downmod}, ${o} ${e.vote.upmod}`:!t&&s?`${e.vote.downmod},${e.vote.upmod}`:t&&!s?`${o} ${n.vote.pressed}`:n.vote.pressed}function W(t,e){let n="";t==="up"&&(n=P("up",e)),t==="down"&&(n=P("down",e)),t==="clear"&&(n=I(e)),N(n)}function M(){let{post:t,special:e,comments:n}=i.old,{comment:o}=n,l=`${o.select}${e.notCollapsed} ${o.expandBtn}`,c=i.latest.comments.threadline;return{postExpBtn:s?`${t.expandBtn}${e.expanded}`:"",comExpBtn:s?l:c}}function C(){let{comments:t,special:e,post:n}=i.old,o={comExpBtn:"",postExpBtn:"",comment:""};return s?(o.comExpBtn=t.comment.expandBtn,o.postExpBtn=`${n.thing} ${t.expandBtn}`,o.comment=`${t.comment.select}${e.collapsed}`):(o.comment=i.latest.comments.comment.select,o.comExpBtn=i.latest.comments.comment.expandBtn),o}async function F(){let{postExpBtn:t,comExpBtn:e,comment:n}=C(),o=!!t&&r(t)||null;if(o&&PluginBase.util.isVisible(o))o.click();else{let l=s?n:e,c,g=Array.from(d(l));for(c of g.reverse())if(PluginBase.util.isVisible(c))return s?r(e,c).click():b(c.parentNode)}}async function G(){let{comment:t,comExpBtn:e}=C(),n=s?`${t} ${e}`:e;for(let o of d(n))s?o.click():b(o.parentNode)}function _(){let{postExpBtn:t,comExpBtn:e}=M(),n=!!t&&r(t)||null,o=d(e);n&&PluginBase.util.isVisible(n)&&n.click();for(let l of o)if(PluginBase.util.isVisible(l)){l.click();break}}function k(){m=!1,a=0}function v(){if(w=location.href,m)return;let{old:t,latest:e}=i,n=s?t.post.thing:e.post.thing;f=d(n),m=!0,T(f,s),s||(window.addEventListener("click",y),x=O(f),q(x))}function S(){setTimeout(()=>{location.hostname.endsWith("reddit.com")?(k(),v(),L(h.test(location.href))):PluginBase.util.removeContext("Post List","Post")},3e3)}function y(){setTimeout(()=>{w!==location.href&&A("popstate")})}function L(t=!1){t?(PluginBase.util.prependContext("Post"),PluginBase.util.removeContext("Post List")):(PluginBase.util.prependContext("Post List"),PluginBase.util.removeContext("Post"))}function A(t){let e=new Event(t);window.dispatchEvent(e)}var D={...PluginBase,init:async()=>{location.hostname.endsWith("reddit.com")&&(s=/https:\/\/old/.test(location.href),await PluginBase.util.ready(),window.addEventListener("load",v),window.addEventListener("popstate",S),setTimeout(()=>{m||A("load")},2e3),L(h.test(location.href)))},destroy:()=>{k(),PluginBase.util.removeContext("Post List","Post"),window.removeEventListener("load",v),!s&&p.disconnect(),!s&&window.removeEventListener("popstate",S),!s&&window.removeEventListener("click",y)},commands:{"Go to Reddit":{pageFn:()=>{document.location.href="https://reddit.com"}}}};return D})();
